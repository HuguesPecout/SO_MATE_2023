---
title: "Représentation graphique avec R"
subtitle: "Tour d'horizon personnel des fonctionnalités graphiques disponibles"
img: images/entete.png
# date: 
author: Hugues Pecout (CNRS, UMR Géographie-Cités)
institute: "Journée annuelle SO-MATE 2023, Limoges"
affiliation: <img src="images/cnrs.png" width="60" style="margin-right:320px;"/><img src="images/somate.png" width="260" style="margin-right:320px;"/><img src="images/geocite.jpeg" width="60" />
lang: fr
editor: source
format:
  revealjs: 
    template-partials:
      - title-slide.html
    theme: [dark, styles.scss]
    logo: images/logo_mate_shs_0.png
    footer: "Journée annuelle SO-MATE 2023 - Représentations graphiques avec R"
    scrollable: TRUE
    smaller: TRUE
    overview: TRUE
    chalkboard: FALSE
    transition: fade
    transition-speed: fast
    code-link: TRUE
    menu: TRUE
    css: style.css
    bibliography: references.bib
    pointer:
      pointerSize: 20
      color: 'red4'
revealjs-plugins:
  - pointer
---

## [Bonjour]{.bigtwo}

\

::: columns
:::{.column width="87%"}
:::: {.big3}
**Hugues Pecout**, ingénieur d'études [CNRS](https://www.cnrs.fr/fr) en **sciences de l'information géographique**
::::
:::: {.big3}
- 2012-2022 : [FR CIST](https://cist.cnrs.fr/) (Collège international des sciences territoriales)   

- Depuis 2022 : [UMR Géographie-Cités](https://geographie-cites.cnrs.fr/) 
::::

:::

:::{.column width="13%"}

![](images/cnrs.png)
:::

:::


[Travail dans le domaine de la **géographie humaine et quantitative (et un peu quali !)**  : collecte, gestion, traitement, enrichissement, analyse (statistique, spatiale, de réseau, textuelle...), représentation graphique et cartographie de **données géographiques hétérogènes** (données conventionnelles, données d'enquête, IGV, webscraping...).]{.big3}


\

::: columns
:::{.column width="55%"}

[Spécialisé dans l'utilisation de R depuis 2015]{.big3}

[Depuis 2018 : Coordination du [projet Rzine](https://rzine.fr/)]{.small2}     
[Depuis 2022 : Co-animateur du groupe d'utilisateur·rices [ElementR](https://elementr.netlify.app/)]{.small2}     
[Depuis 2021 : Membre du [Groupe de travail Notebook](https://gt-notebook.gitpages.huma-num.fr/site_quarto/)]{.small2}   

:::

:::{.column width="45%"}

![](images/Rzine_logo.png){width=25% style="margin-right:25px;"}![](images/ElementR.png){width=25% style="margin-right:30px;"}![](images/notebook_logo.png){width=30% style="margin-bottom:25px;"}

:::

:::






# [Outils de représentation de données]{.bigtwo}

## [Graphiques avec Excel]{.bigone}

::: columns
::: {.column width="25%"}

::: {style="font-size:145%;"} 
✅ **Rapide**   
✅ **Facile**    

\

::: {.txt2}

**Fonctionnalités disponibles :**

❌ Graphiques par défault    
❌ Types de graphiques    
❌ Interactivité        

\

**Gestion des données :**

❌ Manipulation des données         
❌ Statistiques             
❌ Données volumineuses      

\

**Reproductibilité :**

❌ Automatisation du pipeline   
❌ Collaboration         
❌ Versioning
:::
:::
:::

::: {.column width="75%"}
::: {style="margin-top:30px;margin-bottom:15px;font-size:160%;"}
**Mais la représentation graphiques avec Excel connaît des limites...**
:::

![](images/excel.png)

::: {.center style="font-size:80%;"}
[https://excelcharts.com/](https://excelcharts.com/)
:::
:::
:::

## [Graphiques avec des outils dédiés]{.bigone}

[Des **fonctionnalités avancées** et des **sorties graphiques très élégantes**, mais des **logiciels payants**.]{style="font-size:130%;margin-top:10px"}

::: {style="margin-top:-10px;"}
[Bon outils si on ne pratique pas R régulièrement, mais **limité notamment en matière de reproductibilité**.]{style="font-size:130%;"}
:::

::: columns
::: {.column width="20%"}
![](images/power-bi_logo.png){width=80% style="margin-top:10px;"} 
![](images/Tableau-Logo.png){width=80% style="margin-top:-15px;"}    
![](images/ClickView-logo-1.png){width=80% style="margin-top:-15px;"} 
![](images/flourish.jpg){width=80% style="margin-top:20px;"}    
![](images/datawrapper.png){width=80% style="margin-top:20px;"}
![](images/Adobe_Illustrator.png){width=45% style="margin-top:20px;"}  
:::

::: {.column width="5%"}

:::

::: {.column width="75%"}

![](images/power-bi.png){width=90%}

:::

:::


# [Graphiques avec R-base]{.bigtwo}

## [Fonctions graphiques R-base (1995)]{.bigone}

[La version 1.0 de R a été publiée en 2000, mais ce langage est distribué en tant que logiciel Open Source et avec des fonctions graphiques depuis 1995. **Au centre de l'ecosystème graphique du R-base : la fonction** [**`plot()`**](https://www.rdocumentation.org/packages/graphics/versions/3.6.2/topics/plot)]{.bigbis}

::: {.codeXXL style="margin-top:30px;"}
```{r}
#| echo: true
#| out.width: 85%
plot(x = 1, y = 1)
```
:::

## [plot()]{.bigone}

[**Une fonction générique très pratique pour l'exploration, qui s'adapte aux différents types des données.**]{.bigtwo}

::: columns
::: {.column width="50%"}

[1 variable quantitative]{.orange .codeL} - [Nuage de points ordonnés]{.codeL}

::: {.codeXL style="margin-top:10px;"}
```{r}
#| echo: true
#| out.width: 100%
plot(cars$speed)
```
:::

[2 variables quantitatives]{.orange .codeL} - [Nuage de points]{.codeL}

::: {.codeXL style="margin-top:10px;"}
```{r}
#| echo: true
#| out.width: 100%
plot(speed ~ dist, data = cars)
```
:::


[1 variable quanti vs 1 variable quali]{.orange .codeL}  - [Boîte à moustache]{.codeL}

::: {.codeXL style="margin-top:10px;"}
```{r}
#| echo: true
#| out.width: 100%
plot(ncases ~ agegp, data = esoph)
```
:::

:::


::: {.column width="50%"} 

[1 variable qualitative]{.orange .codeL} - [Diagramme en barre]{.codeL}

::: {.codeXL style="margin-top:10px;"}
```{r}
#| echo: true
#| out.width: 100%
plot(esoph$agegp)

```
::: 

[2 variables qualitatives]{.orange .codeL} - [Graphique en mosaic]{.codeL}

::: {.codeXL style="margin-top:10px;"}
```{r}
#| echo: true
#| out.width: 100%

plot(alcgp ~ agegp, data = esoph)
```

:::

[1 variable quali vs 1 variable quanti]{.orange .codeL} - [Spine plot]{.codeL}

::: {.codeXL style="margin-top:10px;"}
```{r}
#| echo: true
#| out.width: 100%
plot(agegp ~ ncases, data = esoph)
```
:::
:::
:::

[Un tableau de données complet]{.orange .codeL} - [Un seul type de graphique]{.codeL}

::: {.codeXL style="margin-top:10px;"}
```{r}
#| echo: true
#| out.width: 100%
plot(iris)
```
:::


## [Autres fonctions graphiques R-base]{.bigone}

::: {.bigbis}
-   `hist()` : histogramme de distribution 
-   `stripchart()` : diagrammes de dispersion
-   `dotchart()` : diagramme en points de Cleveland
-   `boxplot()` : diagramme en boîte
-   `qqnorm()` : diagramme quantile-quantile théorique normal
-   `qqplot()` : diagramme quantile-quantile empirique
-   `barplot()` : diagramme à barres
-   `pie()` : diagramme en secteurs
-   `mosaicplot()` : diagramme en mosaïque
-   `spineplot()` : diagrammes en épine (entre l'histogramme et le mosaic plot)
-   `curve()` : Représentation d'une expression mathématique
-   `matplot()` : Dispersions de toutes le variables d'un tableau (un graphique)
-   `pairs()` : Matrice de nuage de point pour l'ensemble des variables d'un tableau
-   etc....
:::

::: {.bigone}
:::{.callout-note }
En fonction du type de variable, la fonction `plot()` renvoie vers les fonctions `barplot()`,  `spineplot()`, `stripchart()`, `boxplot()`, `curve()`, `pairs()`...
:::
:::

::: columns

::: {.column width="33%"}

[Histogramme de distribution]{.orange .codeL} 

::: {.codeXL style="margin-top:10px;"}
```{r}
#| echo: true
#| out.width: 100%
hist(cars$speed)
```
:::

[Diagrammes de dispersion]{.orange .codeL} 

::: {.codeXL style="margin-top:10px;"}
```{r}
#| echo: true
#| out.width: 100%
stripchart(cars$speed, method = "stack")
```
:::

[Diagrammes en épine]{.orange .codeL}

::: {.codeXL style="margin-top:10px;"}
```{r}
#| echo: true
#| out.width: 100%
spineplot(agegp ~ ncases, data = esoph)
```
:::


:::

::: {.column width="33%"}

[Boîte à moustache]{.orange .codeL}

::: {.codeXL style="margin-top:10px;"}
```{r}
#| echo: true
#| out.width: 100%
boxplot(cars$speed)
```
:::

[Diagramme en points de Cleveland]{.orange .codeL} 

::: {.codeXL style="margin-top:10px;"}
```{r}
#| echo: true
#| out.width: 100%
dotchart(cars$speed)

```
:::


[Camembert]{.orange .codeL}

::: {.codeXL style="margin-top:10px;"}
```{r}
#| echo: true
#| out.width: 100%
# Create data for the graph.
tab <- data.frame(
          name = c("A", "B", "C"),
          value = c(19,53, 88)
         )

# Plot the chart.
pie(tab$value, tab$name)
```
:::

:::

::: {.column width="33%"}

[Diagramme à barres]{.orange .codeL}

::: {.codeXL style="margin-top:10px;"}
```{r}
#| echo: true
#| out.width: 100%
barplot(table(esoph$agegp))
```
:::



[Expression mathématique]{.orange .codeL}

::: {.codeXL style="margin-top:10px;"}
```{r}
#| echo: true
#| out.width: 100%
curve(expr = x^3)
```
:::

[Nuage de points - toutes les variables]{.orange .codeL}

::: {.codeXL style="margin-top:10px;"}
```{r}
#| echo: true
#| out.width: 100%
pairs(iris)
```
:::

:::

:::

## [Les arguments des fonctions graphiques]{.bigone}

[Une multitude d'arguments permettent de paramétrer la mise en page d'un graphique.]{.bigtwo}

```{r}
x <- seq(-pi, pi, 0.1)
y <- sin(x)
```

::: {.codeXL style="margin-top:10px;"}
```{r}
#| echo: true
#| out.width: 100%

plot(y ~ x, 
  type = "o", # type de tracé: points ("p"), lignes ("l"), les deux ("b" ou "o"), ...
  col = "red", # couleur, tapez `colours()` pour la liste complète
  pch = 20, # type de symboles, un chiffre entre 0 et 25, tapez `?points`
  cex = 1.1, # taille des symboles
  lty = 1, # type de lignes, un chiffre entre 1 et 6
  lwd = 1.4, # taille de lignes
  xlim = c(-2.5, 2.5), # limites de l'axe des x
  ylim = c(-1.5, 1.5), # limites de l'axe des y)
  xlab = "La variable x", # titre pour l'axe des x
  ylab = "Le sinus  de x", # titre pour l'axe des y
  main = "La fonction sinus entre -pi et pi" # titre général pour le graphique
) 
```
:::

## [Les fonctions R-base de mise en page]{.bigone}

[Plusieurs fonctions permettent d'ajouter des éléments sur un graphique existant.]{.bigtwo}


::: {.bigbis}
-   `legend()` : légende
-   `title()` : titre
-   `density()` : courbe de densité à noyau
-   `points()` : point
-   `rug()` : représentation *stripchart* le long de l'axe des x
-   `lines()` : segments de droites reliant des points
-   `matlines()` : segments de droites reliant des points (utiliser avec `matplot()`)
-   `abline()` : droites traversant toute la zone graphique
-   `text()` : texte dans la zone graphique
-   `mtext()` : texte dans la marge
-   etc...
:::

::: {.codeXL style="margin-top:30px;"}
```{r eval = TRUE, fig.align='center'}
#| code-fold: TRUE
#| echo: true
#| out.width: 100%

plot(y ~ x, 
  type = "o", # type de tracé: points ("p"), lignes ("l"), les deux ("b" ou "o"), ...
  col = "red", # couleur, tapez `colours()` pour la liste complète
  pch = 20, # type de symboles, un chiffre entre 0 et 25, tapez `?points`
  cex = 1.1, # taille des symboles
  lty = 1, # type de lignes, un chiffre entre 1 et 6
  lwd = 1.4, # taille de lignes
  xlim = c(-2.5, 2.5), # limites de l'axe des x
  ylim = c(-1.5, 1.5), # limites de l'axe des y)
  xlab = "La variable x", # titre pour l'axe des x
  ylab = "Le sinus  de x") # titre pour l'axe des y) 

# Ajout d'un TITRE
title("Titre de mon graphique", 
      cex.main = 1.2,  
      font.main= 4, 
      col.main= "red4")

# Ajout d'une LEGENDE
legend(x = 0.9, # Emplacement de la légende (coin haut gauche)
       y = -1.1, # Emplacement de la légende (coin haut gauche)
       legend = "Fonction sinus entre -pi et pi", 
       bg = "lightgoldenrod",
       col = "red",
       pch = 20,
       cex = 0.7, # Taille de lé lagende
       lty = 1, 
       lwd = 1.4)

# Ajout d'une LIGNE (horizontale)
abline(h = 0, # Coupe l'axe des y à cette valeur 
       lty = 2, # Type de ligne
       lwd = 0.5, # épaisseur
       col = "grey50")

# Ajout d'un POINT
points(x = -0, 
       y = 0, 
       col = "red4", 
       pch = 20,# Type de symbol
       cex = 4)

# Ajout de TEXTE
text("x = 0 = y", # Texte à afficher
     x = 0.4, # Emplacement du texte (centre)
     y = -0.16, # Emplacement du texte (centre)  
     col = "red4")     

# Ajout de TEXTE dans la marge
mtext(text = "Source : données complétement fictives", # Texte à afficher
     side = 4, # Emplacement (1 = bottom, 2 = left, 3 = top...)
     cex = 0.9, # Taille de la police
     col = "grey")  

 
```
:::

## [Gestion de la fenêtre graphique]{.bigone}

[**Trois fonctions permettent de gérer les paramètres de la fenêtre graphique.**]{.bigtwo}

[I. `par()` pour définir ou interroger les paramètres de la fenêtre graphique.]{.bigtwo}

::: {.codeXL style="margin-top:30px;"}   
```{r eval = TRUE, fig.align='center'}
#| code-fold: TRUE
#| echo: true
#| out.width: 100%

par(bg = "royalblue1", # Couleur de fond
    col= "white",      # couleur du graphique
    mfrow = c(2,2),    # Fenêtre découper en deux lignes / deux colonnes (4 graphiques)
    mar = c(5,5,5,5))  # Gestion des marges pour chaque graphique (B,L,T,R)

plot(x = log(1:10), y = 10:1, main = "plot 1")
plot(x = exp(1:10), y = log(1:10), main = "plot 2")
plot(x = sin(1:10), y = 1:10, main = "plot 3")
plot(x = 1:10, y = exp(1:10), main = "plot 4")

```
:::


[II. `layout()` propose moins d’arguments mais permet un meilleur ajustement de la disposition des figures.]{.bigtwo}

::: {.codeXL style="margin-top:30px;"}   
```{r eval = TRUE, fig.align='center'}
#| code-fold: TRUE
#| echo: true
#| out.width: 100%
matrix(c(4, 3, 3, 1, 2, 2, 1, 2, 2), 3, 3)
```
:::

[Avec la matrice ci-dessus, la fenêtre graphique sera paramétrée pour contenir trois graphiques. Le graphique 1 occupera toute la première ligne. le graphique 2 occupera les deux dernières lignes de la première colonne, et le 3e sera situé dans les deux dernières lignes de la dernière colonne.]{.bigbis}

::: {.codeXL style="margin-top:30px;"}   
```{r eval = TRUE, fig.align='center'}
#| code-fold: TRUE
#| echo: true
#| out.width: 100%

# Découpage de la fenêtre graphique
layout(mat = matrix(c(4, 3, 3, 1, 2, 2, 1, 2, 2), 3, 3))

hist(co2, main = "co2")
plot(co2)
boxplot(co2, axes = FALSE)
qqnorm(co2, main = "")

```
:::


[II. `dev.off()` ferme le graphique en cours et réinitialise par défault la fenêtre graphique.]{.bigtwo}

::: {.codeXL style="margin-top:30px;"}   
```{r eval = TRUE, fig.align='center'}
#| code-fold: TRUE
#| echo: true
#| out.width: 100%


par(bg = "royalblue1") 

plot(1,1)

dev.off()

```

```{r eval = TRUE, fig.align='center'}
#| code-fold: TRUE
#| echo: true
#| out.width: 100%

plot(1,1)

```
:::

## [La fonction `locator()`]{.bigone}

::: columns
::: {.column width="70%"}
![](images/locator.webm){width=100% style="margin-top:10px;"} 
:::

::: {.column width="30%"}

\

- [**Permet de récupérer des coordonnées dans la fenêtre graphique**]{.bigtwo}

 \

- [**Peut être utilisé pour du placement intéractif d'éléments de mise en page**]{.bigtwo}

 \
 \

:::{.callout-note}
## Attention
[Ne fonctionne pas avec tous les packages qui proposent des représentations graphiques sur un système de référence orthonormé différent de celui proposé par défault par la fénétre graphique.]{.bigtwo}
:::

:::

:::


## [Limites des fonctions graphiques R-base]{.bigone}

\

::: {.bigone}
Si il existe déjà un certains nombre de fonctionnalités pour la représentation graphique en R-base, ce socle commun présente des limites. Ces fonctions sont très simples d'utilisation, mais sont à privilégier dans un contexte d'exploration des données car :

- [**Les types de représentation graphique sont limitées**]{.elementR}
- [**La syntaxe est peu générique**]{.elementR}
- [**Un graphique + les éléments de mise en page ne peuvent pas être stockés dans un seul objet**]{.elementR}
- [**Le rendu graphique restera toujours assez rudimentaire...** ]{.elementR} 

:::

\

::: {.fatxt}

::: {.callout-important}
## Les extensions graphiques
Il existe de nombreux packages qui offrent une palette importante de fonctionnalités pour la production de graphiques spécifiques et élégants, en seulement quelques lignes de code...

:::

:::


# [La révolution `ggplot2`]{.bigtwo}


## [lattice (2001)]{.bigone}

[Le package `lattice` vise à améliorer les graphiques de base de R en fournissant des valeurs par défaut améliorées et une visualisation simplifiée des relations multivariées.]{.bigtwo} 

::: {.codeXL style="margin-top:30px;"}   
```{r eval = TRUE, fig.align='center'}
library(lattice)
attach(mtcars)

# create factors with value labels
gear.f<-factor(gear,levels=c(3,4,5),
  labels=c("3gears","4gears","5gears"))
cyl.f <-factor(cyl,levels=c(4,6,8),
  labels=c("4cyl","6cyl","8cyl"))

# kernel density plots by factor level (alternate layout)
densityplot(~mpg|cyl.f,
   main="Density Plot by Numer of Cylinders",
   xlab="Miles per Gallon",
   layout=c(1,3))


# boxplots for each combination of two factors
bwplot(cyl.f~mpg|gear.f, 
       ylab="Cylinders", xlab="Miles per Gallon",
       main="Mileage by Cylinders and Gears",
       layout=c(1,3))

# 3d scatterplot by factor level
cloud(mpg~wt*qsec|cyl.f,
   main="3D Scatterplot by Cylinders")
```
:::

[L'une de ses principales caractéristiques est la prise en charge de la création de graphiques en treillis, qui permettent d'afficher des variables ou des relations entre variables, conditionnées par une ou plusieurs autres variables.]{.bigtwo} 

::: {.codeXL style="margin-top:30px;"}   
```{r eval = TRUE, fig.align='center'}
# scatterplots for each combination of two factors
xyplot(mpg~wt|cyl.f*gear.f,
   main="Scatterplots by Cylinders and Gears",
   ylab="Miles per Gallon", xlab="Car Weight")
```
:::


::: {.fatxt} 

::: {.callout-note}
Ce package apporte des fonctionnalités supplémentaires aux fonctions graphiques R-base. Cependant, le rendu graphique reste rudimentaire.
:::

:::
  

  
## [ggplot2 (2007 - 2012)]{.bigone}


::: {style="margin-top:20px;"}   
[**le package `ggplot2` [@Rggplot2] est une véritable révolution en matière de représentation graphique, qui dépasse le périmètre de la communauté R**. Ce package :]{.bigtwo}
:::

::: {.bigtwo}

- Repose sur le concept de La [*Grammar of Graphics*]{.elementR} [@wilkinson:1999:TGOG]
- Produit des graphiques très élégants par défault
- Est adapté au développement d'extensions
- Ouvre la possibilité de construire des **représentations graphiques variées et personnalisées**.

:::

::: columns

::: {.column width="30%" .center}   
::: {.center}   

![](images/gglayers.png)

[[**A Layered Grammar of Graphics**](https://www.uvm.edu/~ngotelli/Rscripts/wickham.2009.pdf) [@doi:10.1198/jcgs.2009.07098]]{.small2}

:::   
:::

::: {.column width="70%"}

::: {.center}
```{r eval = TRUE, fig.align='center'}
#| echo: false
#| eval: false
#| out.width: 80%

library(packageRank)
tabdownload <- cranDownloads(packages = "ggplot2", from = "2012", to = "2023")
tabdown <- tabdownload$cranlogs.data
maxcumuldown <- max(tabdownload$cranlogs.data$cumulative)

library(ggplot2)
library(ggthemes)
ggplot(data = tabdown, mapping = aes(x = date, y = count)) +
  geom_line() + 
  geom_smooth() + 
  ggtitle("ggplot2 download counts by day") + 
  xlab("") +  ylim(0, 160000) +
  ylab("") + theme_economist() + 
  annotate(geom="text", x=as.Date("2014-06-01"), y=125000, label=paste0("Total = ", maxcumuldown, " !"), color="blue4", size = 5, fontface = "bold") + 
  theme(plot.title = element_text(size=20))


```
:::

:::

:::

![](images/gallery_ggplot2.png)

![](images/overview.png)

![](images/switzerland.png)

## [ggplot2, au delà de R...]{.bigone}

::: {style="margin-top:20px;"}  
[**La syntaxe de la [*grammaire des graphiques*]{.elementR}, implementée dans un premier temps en langage R, a été reprise et adaptée dans plusieurs langages de programmation.**]{.bigone}
:::

\

::: {style="margin-top:20px;"}  
[**La grammaire des graphiques avec `ggplot2` :**]{.bigtwo}
:::

::: columns
:::: {.column width="36%"}
::: {.codeXL style="margin-top:22px;"}
```r
library(ggplot2)

ggplot(data = cars) +
  geom_point(aes(x = Horsepower,
                 y = Miles_per_Gallon,
                 color = Origin))
```

::: {.center .bold}

![](images/ggplot2.png){width=40%}

:::{.moymd}     
[https://ggplot2.tidyverse.org/](https://ggplot2.tidyverse.org/)
:::

:::

:::
::::
:::: {.column width="64%"}
![](images/gg_ggplot2.png)
::::
:::




##  La grammaire des graphiques en Python (`altair`)

\

::: columns  
:::: {.column width="30%"}  
::: {.codeXL style="margin-top:22px;"}  
```python
import altair as alt

alt.Chart(cars).
  mark_circle(size=60).
  encode(x='Horsepower',
         y='Miles_per_Gallon',
         color='Origin')
```
:::

::: {.center .bold}
![](images/altair.png){width=80%}

[https://altair-viz.github.io/](https://altair-viz.github.io/)

:::

::::
:::: {.column width="70%"}
![](images/gg_altair.png)
::::
:::


##  La grammaire des graphiques en JavaScript (`vegalite`)

\

::: columns  
:::: {.column width="40%"}  
::: {.codeXL style="margin-top:22px;"}  
```js
{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "data": {"url": "data/cars.json"},
  "mark": "point",
  "encoding": {
    "x": {"field": "Horsepower",
          "type": "quantitative"},
    "y": {"field": "Miles_per_Gallon",
          "type": "quantitative"},
    "color": {"field": "Origin",
              "type": "nominal"}
  }
}
```
:::

::: {.center .bold}

![](images/vegalite.png){width=40%}

   
[https://vega.github.io/vega-lite/](https://vega.github.io/vega-lite/) 


:::

::::

:::: {.column width="60%"}
![](images/gg_vegalite.svg){width="90%"}
::::
:::



##  La grammaire des graphiques en Observable JS (`Plot`)

\

::: columns  
:::: {.column width="30%"}  
::: {.codeXL style="margin-top:22px;"}  

```js
Plot.plot({
  grid: true,
  color: {
    legend: true
  },
  marks: [
    Plot.dot(cars, {
    x: "Horsepower",
    y: "Miles_per_Gallon",
    fill: "Origin"
    })
  ]
})
```
:::

::: {.center .bold}

![](images/plot.svg){width="90%"}
[https://github.com/observablehq/plot](https://github.com/observablehq/plot)

:::

::::

:::: {.column width="70%"}
![](images/gg_observable.png)
::::

:::



## [Les extensions de `ggplot2`]{.bigone}

[De nombreuses extensions de `ggplot2` ont été développées et offrent de nouvelles fonctionnalités en matière de mise en forme, de types de représentation graphique, d'animation, d'intéractivité, d'objet pris en compte...]{.bigtwo}

::: {.center .bold}

![](images/extension_ggplot.png){width="90%"}

::: {.bigtwo}
[https://exts.ggplot2.tidyverse.org](https://exts.ggplot2.tidyverse.org)
:::

:::



## [`esquisse`, pour se lancer !]{.bigone}

[`esquisse` est un package français [@esquisse]. C'est l'une des extensions `ggplot2` les plus téléchargées. Il s'agit d'un *addin* (shiny) pour créer des graphiques `ggplot2` de manière interactive, puis récupérer le code R généré automatiquement.]{.bigtwo}

::: columns  
:::: {.column width="30%"}  
::: {.codeXL style="margin-top:22px;"}  

```{r}
#| eval: false
#| echo: true
library(esquisse)

esquisser()
```

:::

::: {.center .bold}

\
\
\

![](images/esquisse_logo.png){width="75%"}

[https://dreamrs.github.io/esquisse/](https://dreamrs.github.io/esquisse/)

:::


::::

:::: {.column width="70%"}  

::: {.center}
![](images/esquisse.gif){width="80%"}
:::
::::

:::

## [`ggplot2`, de la customization avancée...]{.bigone}



::: {.center}

[X-Men Characters, by **Cedric Scherer**]{.bigtwo}

[https://www.cedricscherer.com/top/dataviz/](https://www.cedricscherer.com/top/dataviz/)

![](images/xmen.jpg)
:::

\



::: {.center}

[Best selling Authors, by **Tania Shapiro**]{.bigtwo}

[https://www.tanyashapiro.com/](https://www.tanyashapiro.com/)

![](images/nyt.png)
:::

\



::: {.center}

**Spatio-temporal Wikidata. Exploration de données ouvertes et liées du web 3.0**, par R. Krummeich, H. Pecout & S. Rey-Coyrehourcq

[https://rzine-reviews.github.io/wikidata_sparql_rzine/#content](https://rzine-reviews.github.io/wikidata_sparql_rzine/#content)

![](images/sparql.png)
:::

## [... à l'art graphique numérique]{.bigone}

::: {.center}

[**Thomas Lin Pedersen** (Rstudio)]{.bigtwo} 

[https://www.data-imaginist.com/art](https://www.data-imaginist.com/art)

:::

::: columns
::: {.column width=50%}
![](images/art_1.png)  
![](images/art_2.png)  
![](images/art_3.png)
:::

::: {.column width=50%}
![](images/art_4.png)   
![](images/art_5.png)  
![](images/art_6.png)
<!-- ![](images/art_7.png) -->

:::
:::



## [Palettes de couleurs]{.bigone}

::: columns
::: {.column width="47%"}
:::: {.center .bold}
[De nombreuses palettes de couleurs sont directement disponibles en R-base :]{.bigtwo} 

![`hcl.colors()`](images/swatch-plot-1.svg)
::::
:::

::: {.column width="6%"}
:::

::: {.column width="47%"}

:::: {.center .bold}

[Au cas où, près de 70 (!) packages proposent des palettes de couleurs]{.bigtwo} 

- `paletteer` [@R-paletteer] propose 2587 palettes (compilation)
- `cols4all` [@R-cols4all], une application shiny pour les explorer

![`cols4all::c4a_gui()`](images/cols4all.png)

::::

:::

:::



# [Quelques packages spécifiques à certaines thématiques...]{.bigtwo}


## [Analyse statistique multivariée]{.bigone}

\

### Package `FactoMineR` [@FactoMineR]

Et ses packages d'exploration et de visualisation associés : `FactoInvestigate`, `factoextra`, `Factoshiny`) [@ade4]

:::: columns

::: {.column width="50%"}

::: {.codeXL style="margin-top:10px;"}
```{r}
#| code-fold: TRUE
#| eval: true
#| echo: true

par(mfrow = c(2, 3))

library("factoextra")
data("decathlon2")

df <- decathlon2[1:23, 1:10]

library("FactoMineR")
res.pca <- PCA(df,  graph = FALSE)

# Visualize eigenvalues/variances
fviz_screeplot(res.pca, addlabels = TRUE, ylim = c(0, 50))

```
:::

:::

::: {.column width="50%"}

::: {.codeXL style="margin-top:10px;"}
```{r}
#| code-fold: TRUE
#| eval: true
#| echo: true

fviz_pca_var(res.pca, col.var="contrib",
             gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
             repel = TRUE # Avoid text overlapping
             )



```
:::

:::

::::

::: columns

::: {.column width="50%"}

::: {.codeXL style="margin-top:10px;"}
```{r}
#| code-fold: TRUE
#| eval: true
#| echo: true
# Contributions of variables to PC1
fviz_contrib(res.pca, choice = "var", axes = 1, top = 10)


```
:::

:::

::: {.column width="50%"}

::: {.codeXL style="margin-top:10px;"}
```{r}
#| code-fold: TRUE
#| eval: true
#| echo: true


# Contributions of variables to PC2
fviz_contrib(res.pca, choice = "var", axes = 2, top = 10)


```
:::

:::

:::

::: columns

::: {.column width="50%"}

::: {.codeXL style="margin-top:10px;"}
```{r}
#| code-fold: TRUE
#| eval: true
#| echo: true
fviz_pca_ind(res.pca, col.ind = "cos2",
             gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
             repel = TRUE # Avoid text overlapping (slow if many points)
             )



```
:::

:::

::: {.column width="50%"}

::: {.codeXL style="margin-top:10px;"}
```{r}
#| code-fold: TRUE
#| eval: true
#| echo: true


# Biplot of individuals and variables
fviz_pca_biplot(res.pca, repel = TRUE)



```
:::

:::

:::

::: {.codeXL style="margin-top:10px;"}
```{r}
#| code-fold: TRUE
#| eval: true
#| echo: true

# Compute PCA on the iris data set
# The variable Species (index = 5) is removed
# before PCA analysis
iris.pca <- PCA(iris[,-5], graph = FALSE)

# Visualize
# Use habillage to specify groups for coloring
fviz_pca_ind(iris.pca,
             label = "none", # hide individual labels
             habillage = iris$Species, # color by groups
             palette = c("#00AFBB", "#E7B800", "#FC4E07"),
             addEllipses = TRUE # Concentration ellipses
             )

```
:::



\

### Package `explor` [@explor]

::: {.codeXL style="margin-top:10px;"}
```{r}
#| eval: false
#| echo: true
library(FactoMineR)
data(hobbies)
res.mca <- MCA(hobbies,quali.sup=19:22,quanti.sup=23)

library(explor)
explor(res.mca)
```
:::

![](images/explor.gif)
  

## [Textométrie - Nuage de mots]{.bigone} 

\

### Package `wordcoud` [@wordcloud]



::: {.codeXL style="margin-top:10px;"}
```{r}
#| code-fold: TRUE
#| eval: false
#| echo: true
#| out.width: 100%

library(wordcloud) 


wordcloud(words = demoFreq$word, 
          freq = demoFreq$freq, 
          min.freq = 1,
          max.words=200, 
          random.order=FALSE, 
          rot.per=0.35,            
          colors=brewer.pal(8, "Dark2"))

```
:::


![](images/wordcloud.png){width="65%"}



\

### Package `wordcoud2` [@wordcloud2]

::: {.codeXL style="margin-top:10px;"}
```{r}
#| code-fold: TRUE
#| eval: false
#| echo: true
#| out.width: 100%

library(wordcloud2) 

wordcloud2(demoFreq, size = 0.7, shape = 'star')
```
:::

![](images/wordcloud2.png){width="65%"}

\

[Ou `ggwordcloud` et `ggwordcloud2` si vous préférez la syntaxe ggplot.]{.bigone}




## [Analyse de réseaux]{.bigone}

\

###  Package `igraph` [@R-igraph]

::: columns
::: {.column width="50%"}

```{r}
#| echo: false

par(mar = c(0,0,0,0))
```


::: {.codeXL style="margin-top:10px;"}
```{r}
#| code-fold: TRUE
#| echo: true
#| out.width: 100%

# Chargement jeu de données exemple
library(igraphdata)
data(karate)

# Affichage d'un objet igraph (réseau)
library(igraph)
plot(karate)
```
:::

:::

::: {.column width="50%"}

::: {.codeXL style="margin-top:10px;"}
```{r mouahahah}
#| code-fold: TRUE
#| echo: true
#| out.width: 100%

# Mise en page  d
plot(karate, 
     vertex.color = V(karate)$Faction,      # couleur des sommets
     vertex.frame.color = "white",          # couleur des contours des sommets
     vertex.shape = "square",               # forme des sommets
     vertex.size = degree(karate),          # taille des sommets
     vertex.label = NA,                     # étiquettes des sommets
     vertex.label.degree = 0,       # position / au centre du sommet (0 = droite, "pi"= gauche)
     edge.color = "goldenrod3",     # couleur des arêtes
     edge.curved=.1,                # courbure des arêtes (0 = droit)
     # arrow.mode = 3,              # type de flèche 
     # edge.arrow.size = 12,        # taille de la pointe de la flèche
     edge.width = E(karate)$weight,          # largeur des arêtes
     edge.lty = 1,                           # type de trait (1=plein, 2=pointillés, 3=points...)
     margin =  c(0,0,0.2,0),                 # marges
     main = graph_attr(karate, "name"),      # titre principal
     sub = graph_attr(karate, "Author"),     # sous-titre
     layout = layout_(karate, with_lgl()))             # sous-titre                   

```
:::

:::

:::

\

###  Package `ggraph` [@ggraph]

::: {.codeXL style="margin-top:10px;"}
```{r}
#| code-fold: TRUE
#| echo: true
#| eval: false
#| out.width: 100%

library(ggraph)
library(tidygraph)
library(tidyverse)

# Create graph of highschool friendships
graph <- as_tbl_graph(highschool) %>% 
    mutate(Popularity = centrality_degree(mode = 'in'))

# plot using ggraph
ggraph(graph, layout = 'kk') + 
    geom_edge_fan(aes(alpha = after_stat(index)), show.legend = FALSE) + 
    geom_node_point(aes(size = Popularity)) + 
    facet_edges(~year) + 
    theme_graph(foreground = 'steelblue', fg_text_colour = 'white')
```
:::

\

###  Package `networkD3` [@networkD3]

::: {.codeXL style="margin-top:10px;"}
```{r toto}
#| code-fold: TRUE
#| echo: true
#| out.width: 100%

data <- data.frame(
  from=c("A", "A", "B", "D", "C", "D", "E", "B", "C", "D", "K", "A", "M"),
  to=c("B", "E", "F", "A", "C", "A", "B", "Z", "A", "C", "A", "B", "K")
)

library(networkD3)
simpleNetwork(data , height="100px", width="100px",        
              Source = 1,                 # column number of source
              Target = 2,                 # column number of target
              linkDistance = 10,          # distance between node. Increase this value to have more space between nodes
              charge = -900,              # numeric value indicating either the strength of the node repulsion (negative value) or attraction (positive value)
              fontSize = 14,              # size of the node names
              fontFamily = "serif",       # font og node names
              linkColour = "#666",        # colour of edges, MUST be a common colour for the whole graph
              nodeColour = "#69b3a2",     # colour of nodes, MUST be a common colour for the whole graph
              opacity = 0.9,              # opacity of nodes. 0=transparent. 1=no transparency
              zoom = T                    # Can you zoom on the figure?
              )
```
:::

\

###  Package `visNetwork`

::: {.codeXL style="margin-top:10px;"}
```{r}
#| code-fold: TRUE
#| echo: true
#| eval: false
#| out.width: 100%
library(visNetwork)

data <- toVisNetworkData(karate)

visNetwork(nodes = data$nodes, edges = data$edges, height = "500px") 

```
:::

```{r}
#| code-fold: TRUE
#| echo: false
#| out.width: 100%
#| eval: false
library(visNetwork)
vn <- visNetwork(nodes = data$nodes, edges = data$edges, height = "500px") 
visSave(vn, file = "images/visnetwork.html")
```


```{=html}
<iframe width="1000" height="540" src="images/visnetwork.html" title="visnetwork"></iframe>
```



## [Analyse de séquence]{.bigone}

\

###  Package `TraMineR`

::: {.codeXL style="margin-top:10px;"}
```{r}
#| code-fold: TRUE
#| echo: true
#| out.width: 100%

library(TraMineR)

data(mvad)

mvad.alphabet <- c("employment", "FE", "HE", "joblessness", "school", "training")
mvad.labels <- c("employment", "further education", "higher education", "joblessness", "school", "training")
mvad.scodes <- c("EM", "FE", "HE", "JL", "SC", "TR")

mvad.seq <- seqdef(mvad, 17:86, 
                   alphabet = mvad.alphabet, 
                   states = mvad.scodes, 
                   labels = mvad.labels, 
                   xtstep = 6)

par(mfrow = c(2, 2))

seqiplot(mvad.seq, with.legend = FALSE, border = NA, main = "The first 10 sequences in the mvad.seq sequence object")
seqIplot(mvad.seq, sortv = "from.start", with.legend = FALSE, main = "All the sequences in the data set, sorted by states from start")
seqfplot(mvad.seq, with.legend = FALSE, border = NA, main ="The 10 most frequent sequences.")
seqlegend(mvad.seq)

```
:::

\

- Gabadinho, A. & Ritschard, G. (2013), Searching for typical life trajectories applied to child birth histories, In R. Lévy & E. Widmer (eds.), Gendered life courses.  pp. 287-312. Vienna: LIT    
- Gabadinho, A., Ritschard, G., Müller, N. S., & Studer, M. (2011). Analyzing and Visualizing State Sequences in R with TraMineR. Journal of Statistical Software, 40(4), 1-37. DOI https://doi.org/10.18637/jss.v040.i04.   s


# Des packages intérréssants du coté des sciences dures

## [*Carte* de chaleur]{.bigone} 

\

### Package `superheat` [@superheat]

```{=html}
<iframe width="1070" height="540" src="https://rlbarter.github.io/superheat/index.html" title="superheat"></iframe>
```

\

### Package `ComplexHeatmap` [@ComplexHeatmap]

```{=html}
<iframe width="1070" height="540" src="https://jokergoo.github.io/ComplexHeatmap-reference/book/index.html" title="ComplexHeatmap"></iframe>
```



## [Graphique circulaire]{.bigone} 

\

### Package `circlize` [@10.1093/bioinformatics/btu393]

```{=html}
<iframe width="1070" height="540" src="https://jokergoo.github.io/circlize_book/book/" title="circlize_book"></iframe>
```




## [Graphique 3D]{.bigone}

\

### Package `Scatterplot3D` [@Scatterplot3d]

```{r}
#| echo: false
data(iris)
```


::: {.codeXL style="margin-top:10px;"}
```{r}
#| code-fold: TRUE
#| echo: true
#| out.width: 100%
library(scatterplot3d)

shapes = c(16, 17, 18) 
shapes <- shapes[as.numeric(iris$Species)]
colors <- c("#999999", "#E69F00", "#56B4E9")
colors <- colors[as.numeric(iris$Species)]


s3d <- scatterplot3d(iris[,1:3], 
                     pch = shapes, 
                     color= colors )

legend("bottom", legend = levels(iris$Species),
      col =  c("#999999", "#E69F00", "#56B4E9"), 
      pch = c(16, 17, 18), 
      inset = -0.25, xpd = TRUE, horiz = TRUE)
```
:::

\

### Package `rgl` [@rgl]



```{r setup}
library(rgl)
knitr::knit_hooks$set(webgl = hook_webgl)
```

::: {.codeXL style="margin-top:10px;"}
```{r, test-rgl2, webgl=TRUE}
#| code-fold: TRUE
#| echo: true
#| out.width: 100%
library(rgl)

x <- sort(rnorm(1000))
y <- rnorm(1000)
z <- rnorm(1000) + atan2(x,y)

plot3d(x, y, z, col = rainbow(1000))
```
:::


## [Cartographie]{.bigone} `r emo::ji("smile")`

\

### Package `sf` [@R-sf]

[Pour importer, manipuler, traiter et afficher des données géographiques vectorielles.]{.bigbis}

::: {.codeXL style="margin-top:10px;"}
```{r}
#| echo: true
#| out.width: 100%
#| message: false

library(sf)

mtq <- st_read(dsn = "data/mtq.gpkg", layer = "mtq")

```

:::

::: {.codeXL style="margin-top:20px;"}

```{r}
#| echo: true
#| out.width: 100%
#| message: false

plot(mtq)

```

:::

::: {.codeXL style="margin-top:10px;"}

```{r}
#| echo: true
#| out.width: 100%
#| message: false

plot(st_geometry(mtq))

```

:::

\

### Package `terra` [@R-terra]

[Pour importer, manipuler, traiter et afficher des données géographiques raster (avec vecteur).]{.bigbis}

::: {.codeXL style="margin-top:10px;"}
```{r}
#| echo: true
#| out.width: 100%

library(terra)

# Couche raster
alt_raw <- rast("data/altitude.tif") 

plot(alt_raw)


# Couche vecteur
mtq_terra <- vect("data/mtq.gpkg", layer="mtq")

plot(mtq_terra)

```
:::

\

### Package `mapsf` [@R-mapsf]

[Pour produire des cartes thématiques.]{.bigbis}

::: columns

:::{.column width="50%"}

::: {.codeXL style="margin-top:10px;"}
```{r}
#| echo: true
#| fig-height: 7

library(mapsf)

mf_map(x = mtq)

mf_map(x = mtq, var = "POP", type = "prop", leg_title = "Population")

mf_layout(title = "Population in Martinique",
          credits = "H. Pecout; Sources: INSEE & IGN, 2018")

```
:::

:::


:::{.column width="50%"}

::: {.codeXL style="margin-top:10px;"}
```{r}
#| code-fold: true
#| echo: true
#| eval: false
#| out.width: 100%

mf_theme("agolalight", bg = "ivory1")

mf_export(
  x = mtq, filename = "images/mtq.png",
  width = 600, res = 120,
  expandBB = c(0, 0, 0, .3)
)

mf_shadow(mtq, col = "grey90", add = TRUE)

mf_map(
  x = mtq, var = "MED", type = "choro",
  pal = "Dark Mint",
  breaks = "quantile",
  nbreaks = 6,
  leg_title = "Median Income\n(euros)",
  leg_val_rnd = -2,
  add = TRUE
)

mf_inset_on(x = "worldmap", pos = "right")

mf_worldmap(mtq, col = "#0E3F5C")

mf_inset_off()

mf_title("Wealth in Martinique, 2015")

mf_credits("T. Giraud\nSources: INSEE & IGN, 2018")

mf_scale(size = 5)

mf_arrow("topleft")

dev.off()




```
:::

![](images/mtq.png)

:::

:::

\

### Package `tmap` [@R-tmap]

[Pour produire des cartes thématiques statique ou intéractive avec la syntaxe ggplot.]{.bigbis}

::: columns

:::{.column width="50%"}

::: {.codeXL style="margin-top:10px;"}
```{r}
#| echo: true
#| out.width: 70%
#| fig-height: 12

library(tmap)

tm_shape(mtq) +
    tm_polygons("STATUS")

```
:::

:::


:::{.column width="50%"}

::: {.codeXL style="margin-top:10px;margin-bottom:10px;"}
```{r}
#| echo: true
#| out.width: 100%

tmap_mode("view")

tm_shape(mtq) +
    tm_polygons("STATUS")

```
:::

:::

:::

\

[Ou encore `ggplot2` & `ggmap` [@R-ggmap]]{.bigbis}


# [Animation, dynamisme & intéractivité]{.bigone} 


## [Graphique animé]{.bigone} 

ggmpa tamp


## [Graphique dynamique]{.bigone} 

Autre (plotly et cie)

Plotly \> ggplot2 \> Plotly.js \> D3.js \> Javascript


## [Graphique intéractif{.bigone} 

### htmlwidgets.org

 (javascript link)

### rbokeh

### rCharts

### highcharter

### echarts4r

### robservable


## [Cartographie intéractive]{.bigone} 


leaflet/Mapview






# [Un graphique avec R, et après ?]{.bigone} 

\

## [Export d'image (pdf, png, jpeg)]{.bigone} 

En `R-base` : 

```{r}
#| eval: false
#| echo: true

pdf(file = "myplot.pdf")

plot(mtcars$wt, mtcars$mpg)
abline(v = 0) 
text(x = 0, y = 1, labels = "Random text")

# Run dev.off() to create the file!
dev.off()

```

\

Avec `ggplot2` :

```{r}
#| eval: false
#| echo: true

library(ggplot2)
ggplot(mtcars, aes(wt, mpg)) + geom_point()

ggsave("myplot.pdf")
```

\ 

En clic-bouton avec Rstudio :

![](images/export.png)

## [Export d'une représentation animée (gif, mp4, HTML)){.bigone}

Possible  notamment ggplot2 et tmp



## [Représentation graphique & *notebook*){.bigone}


\

```{=html}
<iframe width="1070" height="540" src="https://rzine.fr/docs/20191125_ironcurtain/index.html" title="nb_rzine"></iframe>
```


## [Représentation graphique & `shiny`){.bigone}

\

```{=html}
<iframe width="1070" height="540" src="https://gallery.shinyapps.io/082-word-cloud/" title="shiny_app1"></iframe>
```


\


```{=html}
<iframe width="1070" height="540" src="https://gallery.shinyapps.io/063-superzip-example/" title="shiny_app2"></iframe>
```



# [Ressources utiles]{.bigtwo}

## <img src="images/overview_RGG.png" width="53" style="margin-top:0px;margin-bottom:-10px;margin-right:13px;"/> [r-graph-gallery.com](https://r-graph-gallery.com)


```{=html}
<iframe width="1070" height="540" src="https://r-graph-gallery.com/" title="R_Graph_Gallery"></iframe>
```


::: {.center .bigtwo}
[By **Yan Hotlz**](https://www.yan-holtz.com/)
:::



## <img src="images/favicon.webp" width="43" style="margin-top:0px;margin-bottom:-10px;margin-right:10px;"/> [r-charts.com](https://r-charts.com




```{=html}
<iframe width="1070" height="540" src="https://r-charts.com/" title="R_Charts"></iframe>
```


::: {.center .bigtwo}
[By **José Carlos Soage**](https://twitter.com/i/flow/login?redirect_after_login=%2FRCoderWeb%2F)
:::


##  <img src="images/Rzine_logo.png" width="40" style="margin-top:0px;margin-bottom:-10px;margin-right:13px;"/> [rzine.fr](https://rzine.fr)


```{=html}
<iframe width="1070" height="600" src="https://rzine.fr" title="rzine.fr"></iframe>
```



## <img src="images/ggplot2.png" width="43" style="margin-top:0px;margin-bottom:-10px;margin-right:13px;"/> [ggplot2.tidyverse.org](https://ggplot2.tidyverse.org)

```{=html}
<iframe width="1070" height="600" src="https://ggplot2.tidyverse.org/" title="ggplot2"></iframe>
```


## <img src="images/ggplot2.png" width="43" style="margin-top:0px;margin-bottom:-10px;margin-right:13px;"/> [https://exts.ggplot2.tidyverse.org/gallery/](https://exts.ggplot2.tidyverse.org/gallery/)

```{=html}
<iframe width="1070" height="600" src="https://exts.ggplot2.tidyverse.org/gallery/" title="ggextension"></iframe>
```


# [Ateliers pratiques]{.bigtwo} {background-color="white"}

## [Le jeu de données]{.bigtwo} {background-color="white"}


\

:::{.bigone}

:::{.center}

[**Le réseau des routes de poste en France de 1632 à 1833**]{.bigbis .elementR}

:::

:::{.black}

> Nicolas Verdier, Anne Bretagnolle. L'extension du réseau des routes de poste en France, de 1708 à 1833. Histoire des réseaux postaux en Europe du XVIIIe au XXIe siècle, May 2007, Paris, France. pp.155-193. ⟨halshs-00144693⟩

:::

\



::: {.bisbis}
[**2 couches géographiques**]{.elementR} au format [*shapefile*]{.elementR} (.shp) :]

- **Les relais de poste** : couche de **points** géoréférencés 
- **Les route postales** : couche de **lignes** géoréférencés    

[**À 8 dates**]{.elementR} : 1632, 1708, 1733, 1758, 1783, 1810 et 1833
:::


\



[Soit **8 cartographie du réseau** des routes de poste en France **entre 1632 et 1833**.]{.big3}

:::



::: columns

::: {.column width="50%"}
![](images/carte_1632.png)
:::
::: {.column width="50%}
![](images/carte_1708.png)
:::

:::

::: columns

::: {.column width="50%"}
![](images/carte_1733.png)
:::
::: {.column width="50%"}
![](images/carte_1758.png)
:::

:::

::: columns
::: {.column width="50%"}
![](images/carte_1783.png)
:::
::: {.column width="50%"}
![](images/carte_1810.png)
:::

:::

:::{.center}
![](images/carte_1833.png){width="100%"}
:::



\

::: bigone

[**Des relais caractérisés par des variables (attributs)**]{.bigbis}

[Ex: Relais de 1833]{.big3}

```{r}
#| echo: false

# Import des points relais
relais <-  st_read(dsn = "data/RELAIS_1833.shp", quiet = TRUE)



library(DT)
datatable(relais, filter = 'top', options = list(
  pageLength = 6, autoWidth = TRUE
))

```


\
\

[**Des routes caractérisées par des variables (attributs)**]{.bigbis}

[Ex: Routes de 1833]{.big3}

```{r}
#| echo: false

# Import des routes postales
routes <-  st_read(dsn = "data/ROUTES_1833.shp", quiet = TRUE)


library(DT)
datatable(routes, filter = 'top', options = list(
  pageLength = 6, autoWidth = TRUE
))

```

:::

## [Un projet Rstudio pour deux TD]{.bigtwo} {background-color="white"}


[1. Représentation de réseau avec `igraph`]{.bigtwo}  
[2. Cartographie avec `mapsf`]{.bigtwo}

1 projets à télécharger



## [I. Atelier `igraph`]{.bigtwo} {background-color="white"}

::: columns

:::{.column width="60%"}
::: quartodoc
<iframe class="slide2" src="https://elementr.gitpages.huma-num.fr/session_reseau/intro_reseau_igraph/"></iframe>
:::
:::

:::{.column width="40%"}

:::{.center}
<button type="submit" class="btn btn btn-succes">[[ **Consulter le support en plein écran** ](https://elementr.gitpages.huma-num.fr/session_cartographie/tutoriel/){target="_blank"}]{.bigtwo}</button>
:::

\
\

Pour aller plus loin : 

<li>Gabor Csardi, nd, <a href="http://statmath.wu.ac.at/research/friday/resources_WS0708_SS08/igraph.pdf" onclick="window.open(this.href); return false;">*Practical statistical network analysis (with R and igraph)*</a></li>

<li>Katherine Ognyanova, 2016, <a href="https://kateto.net/netscix2016.html" onclick="window.open(this.href); return false;">*Network Analysis and Visualization with R and igraph*</a></li>

<li>Jesse Sadle, 2017, <a href="https://www.jessesadler.com/post/network-analysis-with-r/" onclick="window.open(this.href); return false;">*Introduction to Network Analysis with R*</a></li>

 \

Documentation du package `igraph` [@R-igraph] :

- [Site web](https://r.igraph.org/)     
- [Manuel officiel](https://igraph.org/r/doc/)    
- [Vignette](https://cran.r-project.org/web/packages/igraph/vignettes/igraph.html)   
- [Cheat sheet](https://cheatography.com/trvoldemort/cheat-sheets/igraph/)   

\

:::

:::


## [II. Atelier `mapsf`]{.bigtwo} {background-color="white"}

::: columns

:::{.column width="60%"}
::: quartodoc
<iframe class="slide2" src="https://elementr.gitpages.huma-num.fr/session_cartographie/tutoriel/"></iframe>
:::
:::

:::{.column width="40%"}
:::{.center}
<button type="submit" class="btn btn-success">[[ **Consulter le support en plein écran** ](https://elementr.gitpages.huma-num.fr/session_cartographie/tutoriel/){target="_blank"}]{.bigtwo}</button>
:::

\
\

Pour aller plus loin : 

- [Cartographie avec R](https://rcarto.github.io/cartographie_avec_r/) [@Giraud_Cartographie_avec_R_2023]    
- [Geomatique avec R](https://rcarto.github.io/geomatique_avec_r/)  [@Giraud_Geomatique_avec_R_2023]


Documentation du package `mapsf` [@R-mapsf] :

- [Site web](https://riatelab.github.io/mapsf/)     
- [Vignettes](https://riatelab.github.io/mapsf/articles/)   
- [Cheat sheet](https://raw.githubusercontent.com/riatelab/mapsf/master/vignettes/web_only/img/mapsf_cheatsheet.pdf)   


Une remarque ? Une question ? Une proposition d'amélioration pour `mapsf` ? 

[timothee.giraud@cnrs.fr](mailto:timothee.giraud@cnrs.fr)

::: {.center}
![](images/mapsf.png){width="35%"}
:::

:::


:::




## Sources & bibliographie

\


::: {.bigone}
Plusieurs passages sont fortement inspirés de supports existant, mis gracieusement en ligne par leur auteurs. Trois supports de communication ont principalement été utilisés : 


- **R dans l'univers de la Dataviz**, *Yan Holtz*, RencontresR 2023, Avignon, 2023 - [Disponible en ligne](https://github.com/holtzy/Talk/blob/master/2023/R_in_Dataviz_universe.pdf), Enregistrement [vidéo disponible sur Youtube](https://www.youtube.com/watch?v=RrRXcC4KOzc&list=PLC0_Y4EpEglVaDSXFiqn_lm1v_lcjMDki&index=8)

- **Représentation graphique avec R, ggplot2 et la grammaire graphique**, *Robin Cura*, *Léa Cristophe*, Groupe ElementR, Aubervilliers, 2023 - [Disponible en ligne](https://elementr.gitpages.huma-num.fr/session_graphique/ggplot2/#/title-slide)

- **L'écosystème spatial de R**, *Timothée Giraud*, RencontresR 2023, Avignon, 2023 - [Disponible en ligne](https://rcarto.github.io/RencontresR_2023/#/title-slide), Enregistrement [vidéo disponible sur Youtube](https://www.youtube.com/watch?v=rzARlulrVgQ)

:::

\

### Références bibliographiques

::: {#refs}
:::



##

\

::: {.bigcinq}
**Merci de votre attention**
:::

\
\
\

::: {.center2}

::: {.bigone}  
hugues.pecout@cnrs.fr   
:::

\

::: columns   
::: {.column width="20%"}   

:::

::: {.column width="30%"}   

<img src="images/github.png" width="35" style="margin-top:15px;margin-bottom:-10px;margin-right:7px;"/> [HuguesPecout](https://github.com/HuguesPecout/) 

\

<img src="images/gitlab.png" width="35" style="margin-top:15px;margin-bottom:-10px;margin-right:7px;"/> [hpecout](https://gitlab.huma-num.fr/hpecout) 

:::

::: {.column width="30%"}

<img src="images/twitter.png" width="55" style="margin-top:15px;margin-bottom:-10px;margin-right:12px;"/>[rzine_shs](https://twitter.com/rzine_shs/) 

\

<img src="images/mastodon_icon.png" width="35" style="margin-top:15px;margin-bottom:-10px;margin-right:12px;"/>[rzine@fosstodon.org](https://fosstodon.org/@rzine) 

:::

::: {.column width="20%"}   

:::

:::

\
\
\
\

::: {.bigbis}
**Diaporama** :  [https://HuguesPecout.github.io/SO_MATE_2023/](https://HuguesPecout.github.io/SO_MATE_2023/)    
**Code source** : [https://github.com/HuguesPecout/SO_MATE_2023](https://github.com/HuguesPecout/SO_MATE_2023)   
:::

:::
